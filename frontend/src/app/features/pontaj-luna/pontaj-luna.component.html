<p-table [value]="pontajeGrupate" class="p-datatable-striped p-datatable-gridlines mt-4">
  <ng-template #header>
    <tr>
      <th>Data</th>
      <th>Ora Început</th>
      <th>Ora Sfârșit</th>
      <th>Tip Muncă</th>
      <th>Durata</th>
      <th>Proiect</th>
    </tr>
  </ng-template>
  <ng-template #body let-grup>
    <!-- Rândul principal care afișează data -->
    <tr class="bg-gray-200 font-bold">
      <td colspan="6">{{ grup.data | date: 'dd MMM yyyy' }}</td>
    </tr>

    <!-- Rândurile individuale pentru fiecare pontaj -->
    <tr *ngFor="let pontaj of grup.intrari">
      <td></td>
      <td>{{ pontaj.oraInceput }}</td>
      <td>{{ pontaj.oraSfarsit }}</td>
      <td>{{ pontaj.tipMunca }}</td>
      <td>{{ pontaj.durataMuncita }}</td>
      <td>{{ pontaj.proiect ? pontaj.proiect.denumireaActivitatii : "Norma de bază" }}</td>
    </tr>
  </ng-template>
</p-table>

<div class="flex gap-4 mb-4">
  <select [(ngModel)]="currentMonth" class="border p-2 rounded ">
    <option *ngFor="let month of months; let i = index" [value]="i + 1" class="text-black" >{{ month }}</option>
  </select>

  <input
    type="number"
    [(ngModel)]="currentYear"
    min="2000"
    max="2100"
    class="border p-2 rounded w-24"
  />

  <button
    (click)="loadPontaje()"
    class="bg-sky-600 text-white px-4 py-2 rounded-lg hover:opacity-90"
  >
    Încarcă Pontaje
  </button>

  <button
    (click)="generateExcel()"
    class="bg-green-600 text-white px-4 py-2 rounded-lg hover:opacity-90"
  >
    Exportă Excel
  </button>
</div>

