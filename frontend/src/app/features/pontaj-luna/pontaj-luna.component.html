<div class="bg-blue-200 p-6 rounded-xl shadow-lg">

  <h2 class="text-2xl font-bold mb-4 text-black">Pontaje pentru: {{currentYear}}-{{currentMonth | number: '2.0'}}</h2>

  <div class="flex gap-4 items-center mb-4">
    <select [(ngModel)]="currentMonth"
            class="border p-2 rounded-lg  text-black shadow-sm focus:ring-2 focus:ring-blue-400">
      <option *ngFor="let month of months; let i = index" [value]="i + 1">{{ month }}</option>
    </select>

    <input type="number" [(ngModel)]="currentYear" min="2000" max="2100"
           class="border text-black p-2 rounded-lg w-24 shadow-sm focus:ring-2 focus:ring-blue-400 text-center" />

    <button (click)="loadPontaje()"
            class="bg-sky-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-sky-700 transition">
      Încarcă Pontaje
    </button>

    <button (click)="generateExcel()"
            class="bg-green-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-green-700 transition">
      Exportă Excel
    </button>
  </div>

  @if(!errorMessage){
  <p-table [value]="pontajeGrupate" class="p-datatable-striped p-datatable-gridlines mt-4 rounded-xl">
    <ng-template #header>
      <tr class="bg-black text-white text-center">
        <th class="p-3">Data</th>
        <th class="p-3">Ora Început</th>
        <th class="p-3">Ora Sfârșit</th>
        <th class="p-3">Tip Muncă</th>
        <th class="p-3">Durata</th>
        <th class="p-3">Proiect</th>
      </tr>
    </ng-template>

    <ng-template #body let-grup>
      <tr class="bg-gray-300 font-bold text-center">
        <td colspan="6" class="p-3">{{ grup.data | date: 'yyyy-MM-dd' }}</td>
      </tr>

      <tr *ngFor="let pontaj of grup.intrari" class="hover:bg-gray-100 transition text-center">
        <td></td>
        <td>{{ pontaj.oraInceput }}</td>
        <td>{{ pontaj.oraSfarsit }}</td>
        <td>{{ pontaj.tipMunca }}</td>
        <td>{{ pontaj.durataMuncita }}</td>
        <td>{{ pontaj.proiect ? pontaj.proiect.denumireaActivitatii : "Norma de bază" }}</td>
      </tr>
    </ng-template>
  </p-table>
  } @else {
  <p class="text-red-600 text-center my-20">{{ errorMessage }}</p>
  }
</div>
